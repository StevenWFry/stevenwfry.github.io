<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lesson 13 – Creating Sequences, Synonyms, and Indexes (or: giving your database superpowers it will absolutely abuse) - SQL Guide - swf.wtf</title>
<meta name="description" content="And look, your tables are lovely, but on their own they’re a bit slow, slightly inconvenient, and prone to “who assigned this ID twice?” disasters. This i...">
<link rel="stylesheet" href="/assets/css/site.css">
<link rel="stylesheet" href="/assets/css/sql-guide.css">
</head>
<body>

<div class="cursor" id="cursor"></div>

<nav>
  <div class="inner">
    <a href="/" class="logo">swf.wtf</a>
    <a href="/guides/sql-guide/">&larr; sql guide</a>
  </div>
</nav>

<main class="sql-page">
  <header class="sql-header">
    <div class="sql-eyebrow">SQL Guide Chapter</div>
    <h1>Lesson 13 – Creating Sequences, Synonyms, and Indexes (or: giving your database superpowers it will absolutely abuse)</h1>
    <p>And look, your tables are lovely, but on their own they’re a bit slow, slightly inconvenient, and prone to “who assigned this ID twice?” disasters. This is where sequences, synonyms, and indexes stroll in and say: “What...</p>
    <div class="sql-meta">
      <span class="sql-pill">oracle 19c</span>
      <span class="sql-pill">mysql notes</span>
      <span class="sql-pill">study chapter</span>
    </div>
  </header>

  <article class="chapter">
    <p>And look, your tables are lovely, but on their own they’re a bit slow, slightly inconvenient, and prone to “who assigned this ID twice?” disasters. This is where <strong>sequences</strong>, <strong>synonyms</strong>, and <strong>indexes</strong> stroll in and say: “What if IDs were automatic, names were shorter, and lookups weren’t glacial?”</p>
    <p>This lesson is about those supporting actors that make day‑to‑day SQL less painful.</p>
    <p>You will learn to:</p>
    <ul>
    <li>Create, use, and modify <strong>sequences</strong> (including <code>NEXTVAL</code> and <code>CURRVAL</code>).</li>
    <li>Create private and public <strong>synonyms</strong> to simplify object access.</li>
    <li>Create and maintain <strong>indexes</strong>, including function‑based ones.</li>
    <li>Query dictionary views to inspect sequences, synonyms, and indexes.</li>
    </ul>
    <hr>
    <h2>1. Recap: Schema Objects in Play</h2>
    <p>We now have a cast of schema objects:</p>
    <ul>
    <li><strong>Tables</strong> – store data.</li>
    <li><strong>Views</strong> – virtual tables based on queries.</li>
    <li><strong>Sequences</strong> – generate numbers, usually for keys.</li>
    <li><strong>Indexes</strong> – speed up data retrieval.</li>
    <li><strong>Synonyms</strong> – alternative names for other objects.</li>
    </ul>
    <p>This lesson focuses on sequences, synonyms, and indexes.</p>
    <hr>
    <h2>2. Sequences – Auto‑Number Generators</h2>
    <p>Human‑assigned IDs are a problem: they collide, they get reused, and people forget what number comes next. Sequences fix that.</p>
    <p><strong>Sequences</strong>:</p>
    <ul>
    <li>Automatically generate numeric values.</li>
    <li>Are <strong>shared</strong> objects; multiple sessions can use the same sequence.</li>
    <li>Are commonly used to supply <strong>primary key</strong> values.</li>
    <li>Replace ad‑hoc “find max(id)+1” logic (which is a race‑condition factory).</li>
    <li>Can cache values in memory for speed (at the cost of potential gaps).</li>
    </ul>
    <h3>2.1 Creating a simple sequence</h3>
    <p>Minimal syntax:</p>
    <pre><code class="language-sql">CREATE SEQUENCE demo_seq;</code></pre>
    <p>This uses defaults:</p>
    <ul>
    <li><code>START WITH 1</code></li>
    <li><code>INCREMENT BY 1</code></li>
    <li><code>NOMINVALUE</code></li>
    <li><code>NOMAXVALUE</code></li>
    <li><code>CACHE 20</code></li>
    <li><code>NOCYCLE</code></li>
    </ul>
    <p>You can see details via <code>USER_SEQUENCES</code> later.</p>
    <h3>2.2 Using a sequence in INSERT statements</h3>
    <p>Suppose you have:</p>
    <pre><code class="language-sql">CREATE TABLE demo (
      id   NUMBER PRIMARY KEY,
      name VARCHAR2(25)
    );
    
    CREATE SEQUENCE demo_seq;</code></pre>
    <p>Insert rows using <code>NEXTVAL</code>:</p>
    <pre><code class="language-sql">INSERT INTO demo (id, name)
    VALUES (demo_seq.NEXTVAL, &#x27;Mickey&#x27;);
    
    INSERT INTO demo (id, name)
    VALUES (demo_seq.NEXTVAL, &#x27;Mary&#x27;);</code></pre>
    <p>Query:</p>
    <pre><code class="language-sql">SELECT *
    FROM   demo;</code></pre>
    <p>You’ll see <code>id</code> populated with 1, then 2, etc. The sequence guarantees <strong>unique</strong> values.</p>
    <h3>2.3 Pseudocolumns <code>NEXTVAL</code> and <code>CURRVAL</code></h3>
    <ul>
    <li><code>sequence_name.NEXTVAL</code> – returns the <strong>next</strong> number in the sequence and advances it.</li>
    <li><code>sequence_name.CURRVAL</code> – returns the <strong>current</strong> number, but only after <code>NEXTVAL</code> has been called in the session.</li>
    </ul>
    <p>Example:</p>
    <pre><code class="language-sql">SELECT demo_seq.CURRVAL
    FROM   dual;</code></pre>
    <ul>
    <li>Fails if <code>NEXTVAL</code> hasn’t been used in this session.</li>
    <li>Returns the last value generated by <code>NEXTVAL</code> otherwise.</li>
    </ul>
    <h3>2.4 Customizing sequences</h3>
    <p>Full syntax allows many options:</p>
    <pre><code class="language-sql">CREATE SEQUENCE dept_deptid_seq
      START WITH 280
      INCREMENT BY 10
      MINVALUE 1
      MAXVALUE 9999
      NOCYCLE
      NOCACHE;</code></pre>
    <p>Options cheat‑sheet:</p>
    <ul>
    <li><code>START WITH n</code> – first value.</li>
    <li><code>INCREMENT BY n</code> – step size (can be negative).</li>
    <li><code>MINVALUE n</code> / <code>NOMINVALUE</code>.</li>
    <li><code>MAXVALUE n</code> / <code>NOMAXVALUE</code>.</li>
    <li><code>CYCLE</code> / <code>NOCYCLE</code> – whether to wrap around when hitting max/min.</li>
    <li><code>CACHE n</code> / <code>NOCACHE</code> – how many values to buffer in memory.</li>
    </ul>
    <p><strong>Caching and gaps:</strong></p>
    <p>You may see <strong>gaps</strong> in sequence numbers when:</p>
    <ul>
    <li>A transaction is rolled back after fetching <code>NEXTVAL</code>.</li>
    <li>The instance crashes.</li>
    <li>Cached values are lost when a session ends.</li>
    </ul>
    <p>This is normal; sequences guarantee <strong>uniqueness</strong>, not continuity.</p>
    <h3>2.5 Using a sequence in a column default</h3>
    <p>You can bind a sequence directly as a column’s default:</p>
    <pre><code class="language-sql">CREATE SEQUENCE id_seq;
    
    CREATE TABLE emp (
      id   NUMBER DEFAULT id_seq.NEXTVAL NOT NULL,
      name VARCHAR2(25)
    );
    
    INSERT INTO emp (name) VALUES (&#x27;Smith&#x27;);
    INSERT INTO emp (name) VALUES (&#x27;Jones&#x27;);</code></pre>
    <p>The <code>id</code> column is populated automatically; no need to reference the sequence in each <code>INSERT</code>.</p>
    <h3>2.6 Modifying and dropping sequences</h3>
    <p>Use <code>ALTER SEQUENCE</code> to tweak behavior:</p>
    <pre><code class="language-sql">ALTER SEQUENCE demo_seq
      INCREMENT BY 5
      MAXVALUE 10000
      CACHE 50;</code></pre>
    <p>Rules:</p>
    <ul>
    <li>You must own the sequence or have <code>ALTER</code> privilege on it.</li>
    <li>Changes affect <strong>future</strong> numbers only.</li>
    <li>To restart from a different <code>START WITH</code>, you must <code>DROP</code> and <code>CREATE</code> the sequence anew.</li>
    </ul>
    <p>Drop a sequence:</p>
    <pre><code class="language-sql">DROP SEQUENCE demo_seq;</code></pre>
    <p>Inspect sequences via:</p>
    <pre><code class="language-sql">SELECT sequence_name,
           min_value,
           max_value,
           increment_by,
           cache_size,
           last_number
    FROM   user_sequences;</code></pre>
    <hr>
    <h2>3. Synonyms – Alternative Names for Objects</h2>
    <p>If you constantly type <code>OTHER_USER.REALLY_LONG_TABLE_NAME</code>, eventually you will revolt. <strong>Synonyms</strong> exist to prevent that.</p>
    <p>A <strong>synonym</strong>:</p>
    <ul>
    <li>Is a schema object that provides an <strong>alternate name</strong> for a table, view, sequence, procedure, etc.</li>
    <li>Stores only a pointer to the real object in the dictionary—minimal storage.</li>
    <li>Can hide the owning schema and object name from end users.</li>
    </ul>
    <h3>3.1 Private vs public synonyms</h3>
    <ul>
    <li><strong>Private synonym</strong> – lives in a single schema; only that user (and those with privileges) sees it.</li>
    <li><strong>Public synonym</strong> – lives in the <code>PUBLIC</code> schema; visible to <strong>all</strong> users (subject to underlying object privileges).</li>
    </ul>
    <p>Example – private synonym:</p>
    <pre><code class="language-sql">CREATE SYNONYM dept
    FOR   hr.departments;
    
    SELECT *
    FROM   dept;
    -- actually querying hr.departments</code></pre>
    <p>Example – public synonym (requires <code>CREATE PUBLIC SYNONYM</code> privilege):</p>
    <pre><code class="language-sql">CREATE PUBLIC SYNONYM employees
    FOR   hr.employees;</code></pre>
    <p>The classic example is <code>DUAL</code>:</p>
    <ul>
    <li>Table <code>SYS.DUAL</code> exists in the SYS schema.</li>
    <li>A public synonym <code>DUAL</code> is created, so you simply write <code>SELECT SYSDATE FROM dual;</code>.</li>
    </ul>
    <h3>3.2 Dropping synonyms</h3>
    <pre><code class="language-sql">DROP SYNONYM dept;
    
    DROP PUBLIC SYNONYM employees;</code></pre>
    <p>You must own the synonym or have appropriate system privileges.</p>
    <p>Inspect your synonyms with:</p>
    <pre><code class="language-sql">SELECT synonym_name,
           table_owner,
           table_name
    FROM   user_synonyms;</code></pre>
    <hr>
    <h2>4. Indexes – Speeding Up Queries (and Occasionally Slowing Down Writes)</h2>
    <p>An <strong>index</strong> is a separate structure that helps Oracle find rows more quickly, like a book index for row addresses.</p>
    <p>Indexes:</p>
    <ul>
    <li>Are based on one or more columns.</li>
    <li>Can reduce full‑table scans by providing direct access paths.</li>
    <li>Are maintained automatically by Oracle.</li>
    <li>Speed up reads at the cost of extra work on writes (INSERT/UPDATE/DELETE).</li>
    </ul>
    <h3>4.1 Automatic indexes from constraints</h3>
    <p>When you create:</p>
    <ul>
    <li>A <strong>PRIMARY KEY</strong> constraint, or</li>
    <li>A <strong>UNIQUE</strong> constraint,</li>
    </ul>
    <p>Oracle automatically creates a unique index (unless one already exists) to enforce uniqueness.</p>
    <h3>4.2 Manually creating indexes</h3>
    <p>To create a non‑unique index:</p>
    <pre><code class="language-sql">CREATE INDEX emp_last_name_idx
    ON employees (last_name);</code></pre>
    <ul>
    <li>Useful when a column is frequently used in WHERE/ORDER BY and has a selective distribution.</li>
    </ul>
    <p>To create a unique index explicitly:</p>
    <pre><code class="language-sql">CREATE UNIQUE INDEX emp_email_uk
    ON employees (email);</code></pre>
    <p>This can be paired with a <code>UNIQUE</code> constraint or used standalone.</p>
    <h3>4.3 Function‑based indexes</h3>
    <p>If you frequently query a column through a <strong>function</strong>, Oracle can index the expression instead of the raw column.</p>
    <p>Example – case‑insensitive search on department_name:</p>
    <pre><code class="language-sql">CREATE INDEX dept_name_upper_idx
    ON departments (UPPER(department_name));
    
    SELECT department_name
    FROM   departments
    WHERE  UPPER(department_name) = &#x27;SALES&#x27;;</code></pre>
    <p>The optimizer can now use the function‑based index to avoid scanning the entire table every time.</p>
    <h3>4.4 Multiple indexes on the same columns</h3>
    <p>Oracle allows multiple indexes on the same column set if they differ in:</p>
    <ul>
    <li>Type (e.g., B‑tree vs bitmap).</li>
    <li>Partitioning.</li>
    <li>Uniqueness properties.</li>
    </ul>
    <p>Example:</p>
    <pre><code class="language-sql">CREATE INDEX emp_btree_idx
    ON employees (employee_id, first_name) INVISIBLE;
    
    CREATE BITMAP INDEX emp_bitmap_idx
    ON employees (employee_id, first_name);</code></pre>
    <p>Marking an index <code>INVISIBLE</code> lets you test system performance <strong>as if the index didn’t exist</strong>, without actually dropping it.</p>
    <h3>4.5 Inspecting and dropping indexes</h3>
    <p>Inspect indexes:</p>
    <pre><code class="language-sql">SELECT index_name,
           table_name,
           uniqueness,
           visibility
    FROM   user_indexes
    WHERE  table_name = &#x27;EMPLOYEES&#x27;;
    
    SELECT index_name,
           table_name,
           column_name,
           column_position
    FROM   user_ind_columns
    WHERE  table_name = &#x27;EMPLOYEES&#x27;;</code></pre>
    <p>You’ll see:</p>
    <ul>
    <li>System‑named indexes like <code>SYS_C00NNNN</code> created for primary keys.</li>
    <li>Your own named indexes.</li>
    </ul>
    <p>Drop an index:</p>
    <pre><code class="language-sql">DROP INDEX emp_last_name_idx;</code></pre>
    <p>You must own the index or have <code>DROP ANY INDEX</code> privilege.</p>
    <hr>
    <h2>5. Dictionary Views for Sequences, Synonyms, and Indexes</h2>
    <p>Key views to remember:</p>
    <ul>
    <li><strong>Sequences</strong>:</li>
    <li><code>USER_SEQUENCES</code> – sequences you own.</li>
    <li><strong>Synonyms</strong>:</li>
    <li><code>USER_SYNONYMS</code> – synonyms you own.</li>
    <li><code>ALL_SYNONYMS</code> – synonyms you can access.</li>
    <li><strong>Indexes</strong>:</li>
    <li><code>USER_INDEXES</code> – metadata about your indexes.</li>
    <li><code>USER_IND_COLUMNS</code> – columns used by each index.</li>
    </ul>
    <p>Example queries:</p>
    <pre><code class="language-sql">-- Sequences
    SELECT sequence_name,
           increment_by,
           cache_size,
           last_number
    FROM   user_sequences;
    
    -- Synonyms
    SELECT synonym_name,
           table_owner,
           table_name
    FROM   user_synonyms;
    
    -- Indexes
    SELECT index_name,
           table_name,
           uniqueness
    FROM   user_indexes;</code></pre>
    <hr>
    <h2>6. What You Should Now Be Able to Do</h2>
    <p>By the end of this lesson, you should be able to:</p>
    <ul>
    <li>Create and manage sequences, and use <code>NEXTVAL</code>/<code>CURRVAL</code> directly or via column defaults.</li>
    <li>Recognize sequence caching behavior and why gaps are normal.</li>
    <li>Create private and public synonyms so users don’t have to type <code>OTHER_USER.REALLY_LONG_NAME</code> all day.</li>
    <li>Create, inspect, and drop indexes, including function‑based and invisible indexes, and understand when they help.</li>
    <li>Use dictionary views (<code>USER_SEQUENCES</code>, <code>USER_SYNONYMS</code>, <code>USER_INDEXES</code>, <code>USER_IND_COLUMNS</code>) to see what exists.</li>
    </ul>
    <p>You now have the tools to automate keys, hide ugly object names, and make lookups fast—all of which are great, as long as you remember that every index you add is another thing your poor database has to babysit on every row change.</p>
  </article>

  <div class="chapter-nav">
    <a href="12_Introduction_to_Data_Dictionary_Views.html">&larr; previous</a>
    <a href="13_Creating_Sequences_Synonyms_and_Indexes.md">view source markdown</a>
    <a href="14_Creating_Views.html">next &rarr;</a>
  </div>

  <div class="sql-footer">// sql-guide generated from markdown notes</div>
</main>

<script defer src="/assets/js/site.js"></script>

</body>
</html>
